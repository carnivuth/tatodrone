<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Drone</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <canvas id="canvas" width="600" height="600"></canvas>
  </body>

  <!-- vertex shader -->
  <script id="3d-vertex-shader"  type="x-shader/x-fragment">

attribute vec4 a_position;
attribute vec3 a_normal;
attribute vec2 a_texcoord;

uniform mat4 u_projection;
uniform mat4 u_view;
uniform mat4 u_world;

varying vec2 v_texcoord;
varying vec3 v_normal;

void main() {
  // compute position by positioning the object in the world, translate to the camera, and project to the viewplane
  gl_Position = u_projection * u_view * u_world * a_position;
  // setup texture coordintates
  v_texcoord = a_texcoord;
  v_normal = a_normal;
}
  </script>
  <!-- fragment shader -->
  <script id="3d-fragment-shader"  type="x-shader/x-fragment">

precision highp float;

varying vec2 v_texcoord;
varying vec3 v_normal;

uniform vec3 diffuse;

// color of the object in terms of light components reflected
uniform vec3 ambient;

// light emitted from the object
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

// light parameters
uniform vec3 u_lightDirection;
uniform vec3 u_lightPosition;
uniform vec3 u_lightColor;
uniform sampler2D diffuseMap;

void main () {

  vec4 diffuseMapColor = texture2D(diffuseMap, v_texcoord);
  float effectiveOpacity = opacity * diffuseMapColor.a;

  //gl_FragColor = vec4(200,0,0,1);
  //gl_FragColor = vec4(0,0,0,1);
  gl_FragColor = vec4(
                  // rescale colors
                  vec3(255,255,255)*(vec3(1,1,1) -
                    vec3(
                      emissive +
                      // ambient component
                      ambient * u_lightColor
                      // diffuse component
                      //diffuse * u_lightColor normalize(dot(v_normal,))
                    )
                  ),1);
}
  </script>

  <!-- DEBUGGER -->
  <script type="text/javascript" src="lib/spector.js"></script>

  <!-- import javascript libs -->
  <script type="text/javascript" src="lib/mesh_utils.js"></script>
  <script type="text/javascript" src="lib/glm_utils.js"></script>
  <script type="text/javascript" src="lib/webgl-debug.js"></script>
  <script type="text/javascript" src="lib/webgl-utils.js"></script>
  <script type="text/javascript" src="lib/m4.js"></script>
  <script type="text/javascript" src="lib/jquery-3.6.0.js"></script>
  <script type="text/javascript" src="lib/dat.gui.js"></script>
  <script type="text/javascript" src="lib/load_mesh.js"></script>

  <!-- import javascript source files -->
  <script type="text/javascript" src="utils.js"></script>
  <script type="text/javascript" src="model.js"></script>
  <script type="text/javascript" src="drone.js"></script>
  <script type="text/javascript" src="keyboard.js"></script>
  <script type="text/javascript" src="camera.js"></script>
  <script type="text/javascript" src="light.js"></script>
  <script type="text/javascript" src="debug.js"></script>
  <script type="text/javascript" src="main.js"></script>

</html>
